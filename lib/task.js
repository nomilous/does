// Generated by CoffeeScript 1.4.0
var fluent, tasks;

fluent = require('./decorators').fluent;

tasks = {};

module.exports = {
  create: function(title) {
    var middleware, running, task;
    if (tasks[title] != null) {
      throw new Error("cannot recreate task '" + title + "'");
    }
    tasks[title] = 1;
    running = false;
    middleware = [];
    task = {
      does: function(actionTitle, actionFn) {
        return middleware.push(actionFn);
      },
      start: fluent(function(input) {
        var fn, _i, _len, _results;
        running = true;
        _results = [];
        for (_i = 0, _len = middleware.length; _i < _len; _i++) {
          fn = middleware[_i];
          _results.push(fn(input));
        }
        return _results;
      })
    };
    Object.defineProperty(task, 'title', {
      get: function() {
        return title;
      },
      readonly: true,
      enumerable: true
    });
    Object.defineProperty(task, 'running', {
      get: function() {
        return running;
      },
      readonly: true,
      enumerable: true
    });
    return task;
  }
};
